<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-excercises">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Opdrachten | Full scale open source load testing for development teams with K6</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://codecentric.nl/k6-workshop-api-docs/docs/excercises"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Opdrachten | Full scale open source load testing for development teams with K6"><meta data-rh="true" name="description" content="Opdracht 1"><meta data-rh="true" property="og:description" content="Opdracht 1"><link data-rh="true" rel="icon" href="/k6-workshop-api-docs/img/codecentric.ico"><link data-rh="true" rel="canonical" href="https://codecentric.nl/k6-workshop-api-docs/docs/excercises"><link data-rh="true" rel="alternate" href="https://codecentric.nl/k6-workshop-api-docs/docs/excercises" hreflang="en"><link data-rh="true" rel="alternate" href="https://codecentric.nl/k6-workshop-api-docs/docs/excercises" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/k6-workshop-api-docs/blog/rss.xml" title="Full scale open source load testing for development teams with K6 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/k6-workshop-api-docs/blog/atom.xml" title="Full scale open source load testing for development teams with K6 Atom Feed"><link rel="stylesheet" href="/k6-workshop-api-docs/assets/css/styles.773a8959.css">
<link rel="preload" href="/k6-workshop-api-docs/assets/js/runtime~main.8609e158.js" as="script">
<link rel="preload" href="/k6-workshop-api-docs/assets/js/main.95b939f1.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/k6-workshop-api-docs/"><div class="navbar__logo"><img src="/k6-workshop-api-docs/img/ccnl-colored.svg" alt="codecentric logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/k6-workshop-api-docs/img/ccnl-colored.svg" alt="codecentric logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Codecentric K6 Workshop</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/k6-workshop-api-docs/docs/intro">Introductie</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/k6-workshop-api-docs/docs/excercises">Opdrachten</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/k6-workshop-api-docs/docs/usecase">Usecases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/k6-workshop-api-docs/docs/usecase1">Usecase 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/k6-workshop-api-docs/docs/usecase2">Usecase 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/k6-workshop-api-docs/docs/usecase3">Usecase 3</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/k6-workshop-api-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Opdrachten</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Opdrachten</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="opdracht-1">Opdracht 1<a class="hash-link" href="#opdracht-1" title="Direct link to heading">​</a></h2><p>We gaan K6 uitproberen, maak lokaal een testscript aan op je laptop dat 1 http call naar google.nl doet. Als je klaar bent met het script voer het script uit via de commandline.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">k6 run script scriptnaam.js</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="opdracht-2">Opdracht 2<a class="hash-link" href="#opdracht-2" title="Direct link to heading">​</a></h2><p>Nu gaan we daadwerkelijk een test uitvoeren op de Raspberry PI. Dit keer gebruiken we de options function om de parameter vu en duration aan me te teven. </p><ul><li>VU staat voor virtual users. Oftewel het aantal virtuele gebruikers dat je tijdens de performance test wilt simuleren.</li><li>Duration wordt gebruikt om de testduur aan te geven.</li></ul><p>Deze parameters kan je meegeven in de commandline of in het script via de options function. Voer verschillende testen uit waarbij je de waardes van het aantal vusers en de duration wisselt. Blijf goed monitoren tijdens de test om te kijken wat er gebeurt. Client-side kun je monitoren in je terminal, server-side kun je monitoren via het grafana dashboard wat is uitgelegd in de introductie. De client-side monitor je om het verloop van je test in de gaten te houden. Server-side monitor je om te zien hoe het SUT (System Under Test) zich houdt tijdens de performancetest.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="opdracht-3">Opdracht 3<a class="hash-link" href="#opdracht-3" title="Direct link to heading">​</a></h2><p>Zoals je wellicht is opgevallen worden de testresultaten van K6 gelogd in de terminal. Dit is niet optimaal, omdat resultaten in de terminal niet opgeslagen worden. Daarom wil je dit het liefst in een testrapport opslaan, zodat je de resultaten later nog eens kunt terugkijken. Volg de stappen in de github repository voor het implemeteren van een testrapport.</p><p><a href="https://github.com/benc-uk/k6-reporter" target="_blank" rel="noopener noreferrer">K6 report implementeren</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="opdracht-4">Opdracht 4<a class="hash-link" href="#opdracht-4" title="Direct link to heading">​</a></h2><p>Voer een drie keer een performancetest uit met 15 vusers en een duration van 2 minuten. Noteer na elke test het aantal http_requests, wat valt je op?</p><p>Als je de resultaten van de testuitvoer vergelijkt, valt je als het goed is op dat het aantal http_requests bij elke testrun verschillend is. Dit heeft te maken met de responsetijd van de Raspberry PI. Hoe sneller de Raspberry PI een response terug geeft, hoe meer http requests verwerkt kunnen worden. Helaas, is dit geen gewenst gedrag. Hierdoor kan je niet vaststellen wat de test doet en weet je dus niet precies met welke load de test wordt uitgevoerd.</p><p>Los dat probleem in deze opdracht op.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="opdracht-5">Opdracht 5<a class="hash-link" href="#opdracht-5" title="Direct link to heading">​</a></h2><p>Een performancetest heeft net zoals bij andere soorten testen validatie nodig. Het valideren van het test resultaat zorgt ervoor dat je zeker weet dat je bijvoorbeeld het juiste response terug krijgt. K6 heeft verschillende validaties beschikbaar, daarnaast is het ook mogelijk om je eigen validatie te maken. In deze opdracht gebruiken we alleen de standaard validatie technieken van K6.</p><p>Kies 2 of 3 validaties en verwerk deze in je test. Voer daarna de test een aantal keer opnieuw uit om te zien of de validaties werken.</p><p>Probeer ook eens je test te laten falen door de validatie. Verander bijvoorbeeld je testopzet eens.</p><p><a href="https://k6.io/docs/using-k6/checks" target="_blank" rel="noopener noreferrer">Hulp nodig?</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="opdracht-6">Opdracht 6<a class="hash-link" href="#opdracht-6" title="Direct link to heading">​</a></h2><p>Naast checks zijn er ook thresholds beschikbaar in K6. Het verschil is dat een check een true/false output heeft en werkt op request basis. Bijvoorbeeld gaf dit request een &quot;http 200&quot; terug?
Thresholds zijn pass/fail criteria en functioneren over de hele test. Een threshold controleert bijvoorbeeld of de gemiddelde responsetijd lager was dan 0.2 seconden.</p><p>Implementeer 2 of meer verschillende thresholds in je test</p><p><a href="https://k6.io/docs/using-k6/thresholds" target="_blank" rel="noopener noreferrer">Hulp nodig?</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="opdracht-7">Opdracht 7<a class="hash-link" href="#opdracht-7" title="Direct link to heading">​</a></h2><p>Een trend is een object die beschikbaar is in K6 en het mogelijk maakt om berekeningen te maken van requests zoals (min, max, gemiddelde of percentielen). De waardes min en max wil je zo min mogelijk gebruiken, dit geeft namelijk een vertekend beeld van de test. Beter is om percentielen te gebruiken. Deze kan je lezen als in 90 procent van de gevallen was de responsetijd voor request A 0,124 seconden.</p><p>Implementeer een Trend in de test.</p><p><a href="https://k6.io/docs/javascript-api/k6-metrics/trend" target="_blank" rel="noopener noreferrer">Hulp nodig?</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="opdracht-8">Opdracht 8<a class="hash-link" href="#opdracht-8" title="Direct link to heading">​</a></h2><p>Wanneer de test steeds groter wordt krijg je meer te maken met variabelen. Het beste is om deze variabelen in je test te parametriseren. Daarom is het handig om een configuratie bestand te maken die deze waardes bevat en ook gelijk op 1 plek staat.</p><p>Maak een configuratie bestand: <b>.env</b>. Voeg alle hardcoded variabelen toe aan het env bestand en implenteer het env bestand in de test via een import statement. Voer de test opnieuw uit, als je de variabelen goed hebt geparametriseerd, functioneert de test zoals daarvoor. hebt gedaan functioneert je test zoals ervoor.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="opdracht-9">Opdracht 9<a class="hash-link" href="#opdracht-9" title="Direct link to heading">​</a></h2><p>Om logica te scheiden van implementatie maken we een service die gebruikt wordt in het test script. Creëer een functie in service.js die een getRequest afhandelt. Verwerk de implementaties uit de vorige opdrachten ook in de service</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/DanielvanBavel/k6-workshop-api-docs/docs/excercises.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/k6-workshop-api-docs/docs/intro"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Introductie</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/k6-workshop-api-docs/docs/usecase"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Usecases</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#opdracht-1" class="table-of-contents__link toc-highlight">Opdracht 1</a></li><li><a href="#opdracht-2" class="table-of-contents__link toc-highlight">Opdracht 2</a></li><li><a href="#opdracht-3" class="table-of-contents__link toc-highlight">Opdracht 3</a></li><li><a href="#opdracht-4" class="table-of-contents__link toc-highlight">Opdracht 4</a></li><li><a href="#opdracht-5" class="table-of-contents__link toc-highlight">Opdracht 5</a></li><li><a href="#opdracht-6" class="table-of-contents__link toc-highlight">Opdracht 6</a></li><li><a href="#opdracht-7" class="table-of-contents__link toc-highlight">Opdracht 7</a></li><li><a href="#opdracht-8" class="table-of-contents__link toc-highlight">Opdracht 8</a></li><li><a href="#opdracht-9" class="table-of-contents__link toc-highlight">Opdracht 9</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 codecentric K6 workshop</div></div></div></footer></div>
<script src="/k6-workshop-api-docs/assets/js/runtime~main.8609e158.js"></script>
<script src="/k6-workshop-api-docs/assets/js/main.95b939f1.js"></script>
</body>
</html>